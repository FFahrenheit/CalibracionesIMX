<div *ngIf="exists; else not_found" class="card my-3 pb-3">
    <div class="container text-center pt-1">
        <div class="row ml-1">
            <h4 class="text-left my-3"> {{ device['descripcion'] || '' }} - {{ id }} </h4>
        </div>

        <div class="row justify-content-center">
            <div class="col-md-5">

                <div>
                    <a (click)="getDetails()" class="black-link" title="Ver detalles del equipo">
                        <h5 class="text-left subtitle-att">
                            Detalles del equipo
                            <i class="fas fa-external-link-alt"></i>
                        </h5>
                    </a>

                    <attr name="ID" [value]="id"></attr>
                    <attr name="Descripcion" [value]="device.descripcion"></attr>
                    <attr name="Numero de serie" [value]="device.serie"></attr>
                    <attr name="Ubicacion" [value]="device.ubicacion"></attr>
                    <attr name="Tipo de calibracion" [value]="device.calibracion"></attr>
                    <attr name="Error" [value]="errorPipe.transform(device.error)"></attr>
                    <attr name="Resolución" [value]="resolution.transform(device.resInf,device.resSup)"></attr>
                    <attr name="Estado del dispositivo" [value]="device.activo" [status]="getActive()"></attr>
                    <attr name="Estado de calibracion" [value]="device.estado" [status]="getStatus()"></attr>
                    <attr name="Periodo de calibración"
                        [value]="device.periodo == 1 ? '1 año' : device.periodo + ' años'">
                    </attr>

                    <div>
                        <h6 class="text-left subtitle-att">Responsables del equipo</h6>
                        <ul class="dot-list" *ngIf="device.responsables.length > 0; else empty_responsables">
                            <li *ngFor="let r of device.responsables">
                                {{ r.nombre }}
                            </li>
                        </ul>
                        <ng-template #empty_responsables>
                            <span class="empty text"> No hay información de los responsables de este equipo</span>
                        </ng-template>
                    </div>
                </div>

                <div class="mb-2">
                    <h5 class="text-left subtitle-att"> Estado de préstamo </h5>
                    <div *ngIf="device.prestatario == null; else not_available">
                        <attr name="Estado del equipo" value="Disponible para préstamo" status="ok"></attr>
                    </div>
                    <ng-template #not_available>
                        <attr name="Estado del equipo" value="Prestado" status="not-ok"></attr>
                        <attr name="Prestatario" [value]="device.nombrePrestatario + ' (' + device.prestatario + ')'">
                        </attr>
                    </ng-template>
                </div>

            </div>
            <div class="col-md-7 table-responsive container text-center">


                <div>
                    <h5 class="text-left subtitle-att">Historial de préstamos</h5>
                    <table class="table table-hover table-bordered table-sm"
                        *ngIf="device.calibraciones.length > 0; else empty_calibraciones">
                        <thead>
                            <tr class="header">
                                <th scope="col">
                                    Fecha
                                </th>
                                <th scope="col">
                                    Prove-Calibración
                                </th>
                                <th scope="col">
                                    Verificó
                                </th>
                                <th scope="col">
                                    Verif. de etiqueta
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let c of device.calibraciones">
                                <td>
                                    {{ c.fecha| date:'mediumDate' }}
                                    {{ c.fecha| date:'shortTime' }}
                                </td>
                                <td>
                                    <a *ngIf="c.ryr != null; else just_ryr" title="Ver pruebas RYR"
                                        [href]="downloadFile(c.ryr)" target="_blank" class="black-link">
                                        {{ c.calibrador }}
                                        <i class="fas fa-external-link-alt"></i>
                                    </a>
                                    <ng-template #just_ryr>
                                        {{ c.calibrador }}
                                    </ng-template>
                                </td>
                                <td> {{ c.verifico }} </td>
                                <td>
                                    <a *ngIf="c.certificado != null; else just_ok" title="Ver certificado"
                                        [href]="downloadFile(c.certificado)" target="_blank" class="black-link">
                                        Ok
                                        <i class="fas fa-external-link-alt"></i>
                                    </a>
                                    <ng-template #just_ok>
                                        Ok
                                    </ng-template>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <ng-template #empty_calibraciones>
                        <span class="empty text"> No hay información del historial de calibraciones de este
                            equipo</span>
                    </ng-template>
                </div>
            </div>
        </div>
    </div>
</div>
<ng-template #not_found>
    <error-message type="error" title="ERROR" [loading]="exists"
        description="No se encontró el dispositivo con el ID especificado">
    </error-message>
</ng-template>